# Changelog

All notable changes to this project will be documented in this file.

## [unreleased]

### Bug fixes

- Reduce mysql pool max connections option
- Avoid panic in case of rank error
- Avoid collision on map leaderboard

## [0.4.6] - 2024-10-13

### Bug fixes

- Error when updating event leaderboards
- Retry after deadlock error
- Update leaderboard when retrieving rank

### Features

- Better error report endpoint
- Add leaderboard command for admins

### Miscellaneous Tasks

- Mariadb ci

### Refactor

- Allow more simulatenous finishes
- Splitting base code into modules
- Test many finishes leaderboard
- Merge clear_redis_mappacks and admin
- Wait for simultaneous finishes

### Revert

- Remove manual db connection closes

## [0.3.1] - 2024-08-11

### Bug fixes

- Unsynchronized leaderboards state

## [0.3.0] - 2024-08-10

### Bug fixes

- Avoid showing not yet released events
- Not retrieving non-pb records for an event
- Removed escaped names from the api
- Return record date in utc format

### Documentation

- Enhanced the overall documentation
- Api source file for bash

### Features

- Fields `authors` and `end_date` for edition
- Enhanced internal documentation
- Allow save of non-event records to event
- Record saving in non-event ctx
- Add transitive save flag
- Try count on record
- Return old rank on player finish
- Allow many articles for the website

### Refactor

- Remove reversed leaderboards feature
- Better mappack/events scores management
- Using new opt event type
- Mpdefault module and default consts

## [0.2.7] - 2024-05-11

### Features

- /player/ac route
- Using `mkenv` crate for env init
- Ttl for events
- Populate event with mappack mx id
- Sort event maps records
- Staggered requests

## [0.2.6] - 2024-04-15

### Bug fixes

- Db returning null for events without category
- Usernames not escaped
- Add ttl for mappack related keys
- Wrong last/worst rank when calculating scores
- Map last rank set at 0 on empty records
- Persist event mappack in redis after populate
- Temporary hardcode for benchmark 2
- Using wrong mappack id for events
- Overflow when calculating remaining time

### Features

- Returning medal times for each map for `/event/<handle>/<edition_id>` route
- Filling rest of response with empty categories
- Allowing retrieving mappack from event
- Retrieve event edition admins
- Add relations between maps and events
- Info of leaderboard row in event player info
- Unfinished maps for player in event
- `latestnews_image` route
- Next update of mappack scores in graphql
- Next opponent in campaign page

## [0.2.5] - 2023-11-10

### Bug fixes

- Overview query
- Including storm map pack
- Avoiding cloning maps name and uids
- Moved `last_rank` field to `MappackMap` struct
- Avoiding hashmap usage for map pack scores calculations

### Features

- Using sql transaction for `/player/finished` route
- Returning request id for graphql errors
- Mappack branch for graphql
- Added `/info` route

## [0.2.4] - 2023-11-04

### Bug fixes

- Wrong latest records shown for a player on the website
- Logging wrong message in console
- Not using transaction for `/player/finished` route
- Avoiding retrieving object from redis pool in loop

### Features

- Added `/player/report_error` route
- Returning request id on error

### Refactor

- Grouped arguments of some util functions
- Using sql transaction for a record insert

## [0.2.3] - 2023-10-25

### Bug fixes

- Temporary system for benchmark
- /player/pb routes returning wrong cps times
- Optimized sql queries for graphql route
- Benchmark maps leaderboard not showing

## [0.2.1] - 2023-07-30

### Bug fixes

- Full update after missing rank
- Redis leaderboard updating incorrectly

## [0.2.0] - 2023-07-24

### Bug fixes

- Avoided sql syntax error with wrong map id
- Permanent ban not retrieved
- Auth state not shared across server
- Not compiling without feature

### Features

- Logging info when client token deleted
- Added times route

<!-- generated by git-cliff -->
